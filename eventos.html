<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eventos | SEP Minecraft</title>

<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0a0a0a, #003333, #0a0a0a, #001a1a);
    background-size: 400% 400%;
    animation: neonBackground 20s ease infinite;
    color: #fff;
    text-align: center;
    padding: 20px;
  }
  @keyframes neonBackground {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  h1 {
    color: #00ffcc;
    font-size: 3rem;
    margin-top: 2rem;
    text-shadow: 0 0 15px #00ffcc;
  }
  .eventos-box {
    background: #111;
    border: 2px solid #00ffcc;
    border-radius: 15px;
    padding: 1.5rem;
    margin: 2rem auto;
    max-width: 800px;
    box-shadow: 0 0 20px #00ffcc50;
    text-align: left;
  }
  .eventos-box li {
    position: relative;
    background: #222;
    border: 1px solid #555;
    padding: 0.8rem;
    margin: 0.5rem 0;
    border-radius: 10px;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeIn 0.5s forwards;
  }
  .delete-btn {
    position: absolute;
    top: 5px;
    right: 10px;
    cursor: pointer;
    font-size: 1.2rem;
  }
  @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
  .btn {
    display: inline-block;
    background: #111;
    border: 2px solid #0ff;
    color: #0ff;
    padding: 0.8rem 1.5rem;
    margin: 1rem auto;
    border-radius: 10px;
    text-decoration: none;
    transition: 0.2s ease;
    font-size: 1.1rem;
    cursor: pointer;
  }
  .btn:hover { background: #0ff; color: #000; box-shadow: 0 0 20px #0ff; }

  .modal {
    display: none;
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.85);
    align-items: center; 
    justify-content: center;
    z-index: 1000;
    animation: fadeIn 0.3s forwards;
  }
  .modal-content {
    background: #111;
    padding: 20px;
    border-radius: 15px;
    border: 2px solid #0ff;
    box-shadow: 0 0 15px #0ff;
    text-align: center;
    max-width: 400px;
    width: 90%;
  }
  .modal-content input,
  .modal-content textarea {
    padding: 10px;
    margin: 5px 0;
    width: 100%;
    border-radius: 8px;
    border: 1px solid #0ff;
    background: #222;
    color: #fff;
  }
  .modal-content img {
    max-width: 100px;
    margin-top: 5px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<h1>üìÖ Eventos del Servidor</h1>

<div class="eventos-box">
  <ul id="eventos-lista">
    <li>üìå No hay eventos. ¬°Crea uno!</li>
  </ul>
</div>

<button id="crearEventoBtn" class="btn">‚ûï Crear evento</button>
<a href="index.html" class="btn">‚¨Ö Volver al inicio</a>

<!-- MODAL -->
<div id="eventModal" class="modal">
  <div class="modal-content">
    <h3>üîí Ingresa la contrase√±a</h3>
    <input id="passwordInput" type="password" placeholder="Contrase√±a">
    <button id="passwordSubmit" class="btn">Aceptar</button>
    <button id="passwordCancel" class="btn">Cancelar</button>

    <!-- FORMULARIO EVENTO -->
    <div id="formEvento" style="display:none; margin-top:10px;">
      <input type="text" id="nombreEvento" placeholder="Nombre del evento">
      <input type="date" id="diaEvento">
      <input type="time" id="horaEvento">
      <input type="text" id="lugarEvento" placeholder="Lugar / Juego / Canal Discord">
      <textarea id="descEvento" placeholder="Descripci√≥n"></textarea>
      <input type="file" id="imgEvento" accept="image/*">
      <button id="guardarEvento" class="btn">üíæ Guardar evento</button>
    </div>
  </div>
</div>

<script>
const lista = document.getElementById("eventos-lista");
const modal = document.getElementById("eventModal");
const passInput = document.getElementById("passwordInput");
const passSubmit = document.getElementById("passwordSubmit");
const passCancel = document.getElementById("passwordCancel");
const formEvento = document.getElementById("formEvento");
const crearBtn = document.getElementById("crearEventoBtn");
const guardarBtn = document.getElementById("guardarEvento");

let eventos = JSON.parse(localStorage.getItem("eventos")) || [];

// Funci√≥n para mostrar eventos
function mostrarEventos() {
  lista.innerHTML = "";
  if(eventos.length===0){
    lista.innerHTML = '<li>üìå No hay eventos. ¬°Crea uno!</li>';
    return;
  }
  eventos.forEach((e,i)=>{
    const li = document.createElement("li");
    li.innerHTML = `
      <strong>${e.nombre}</strong><br>
      üìÖ ${e.dia} ‚è∞ ${e.hora}<br>
      üìç ${e.lugar}<br>
      ${e.imagen ? `<img src="${e.imagen}" alt="imagen"><br>` : ""}
      ${e.descripcion ? `<em>${e.descripcion}</em>` : ""}
      <span class="delete-btn" title="Borrar evento">üóëÔ∏è</span>
    `;
    lista.appendChild(li);

    li.querySelector(".delete-btn").addEventListener("click", ()=>{
      pedirPassword().then(ok=>{
        if(!ok) return;
        eventos.splice(i,1);
        localStorage.setItem("eventos", JSON.stringify(eventos));
        mostrarEventos();
      });
    });
  });
}

// Pedir contrase√±a
function pedirPassword(){
  return new Promise(resolve=>{
    modal.style.display = "flex";
    formEvento.style.display = "none";
    passInput.value = "";
    passInput.focus();

    function aceptar(){
      if(passInput.value !== "1771"){
        alert("‚ùå Contrase√±a incorrecta.");
        resolve(false);
        return;
      }
      cleanup();
      resolve(true);
    }

    function cancelar(){
      cleanup();
      resolve(false);
    }

    function cleanup(){
      modal.style.display = "none";
      passSubmit.removeEventListener("click", aceptar);
      passCancel.removeEventListener("click", cancelar);
    }

    passSubmit.addEventListener("click", aceptar);
    passCancel.addEventListener("click", cancelar);
  });
}

// Crear evento
crearBtn.addEventListener("click", async ()=>{
  const ok = await pedirPassword();
  if(!ok) return;
  formEvento.style.display = "block";
});

// Guardar evento
guardarBtn.addEventListener("click", ()=>{
  const nombre = document.getElementById("nombreEvento").value;
  const dia = document.getElementById("diaEvento").value;
  const hora = document.getElementById("horaEvento").value;
  const lugar = document.getElementById("lugarEvento").value;
  const desc = document.getElementById("descEvento").value;
  const fileInput = document.getElementById("imgEvento");

  if(!nombre || !dia || !hora || !lugar){
    alert("‚ùå Completa todos los campos obligatorios.");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e){
    eventos.push({
      nombre,
      dia,
      hora,
      lugar,
      descripcion: desc,
      imagen: e.target.result
    });
    localStorage.setItem("eventos", JSON.stringify(eventos));
    mostrarEventos();
    formEvento.style.display = "none";
    modal.style.display = "none";
  };

  if(fileInput.files[0]){
    reader.readAsDataURL(fileInput.files[0]);
  } else {
    eventos.push({nombre,dia,hora,lugar,descripcion:desc,imagen:""});
    localStorage.setItem("eventos", JSON.stringify(eventos));
    mostrarEventos();
    formEvento.style.display = "none";
    modal.style.display = "none";
  }
});

mostrarEventos();
</script>

</body>
</html>
