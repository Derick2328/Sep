<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Eventos | SEP Minecraft</title>

<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0a0a0a, #003333, #0a0a0a, #001a1a);
    background-size: 400% 400%;
    animation: neonBackground 20s ease infinite;
    color: #fff;
    text-align: center;
    padding: 20px;
  }

  @keyframes neonBackground {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }

  h1 {
    color: #00ffcc;
    font-size: 3rem;
    margin-top: 2rem;
    text-shadow: 0 0 15px #00ffcc;
  }

  .eventos-box {
    background: #111;
    border: 2px solid #00ffcc;
    border-radius: 15px;
    padding: 1.5rem;
    margin: 2rem auto;
    max-width: 800px;
    box-shadow: 0 0 20px #00ffcc50;
    text-align: left;
  }

  .eventos-box li {
    background: #222;
    border: 1px solid #555;
    padding: 0.8rem;
    margin: 0.5rem 0;
    border-radius: 10px;
    opacity: 0;
    transform: translateY(20px);
    animation: fadeIn 0.5s forwards;
    position: relative;
  }

  @keyframes fadeIn {
    to { opacity: 1; transform: translateY(0); }
  }

  .btn {
    display: inline-block;
    background: #111;
    border: 2px solid #0ff;
    color: #0ff;
    padding: 0.8rem 1.5rem;
    margin: 1rem auto;
    border-radius: 10px;
    text-decoration: none;
    transition: 0.2s ease;
    font-size: 1.1rem;
    cursor: pointer;
  }

  .btn:hover {
    background: #0ff;
    color: #000;
    box-shadow: 0 0 20px #0ff;
  }

  /* BOTÃ“N BORRAR */
  .borrar-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    background: transparent;
    border: none;
    font-size: 22px;
    cursor: pointer;
    color: #ff4444;
    text-shadow: 0 0 5px #ff4444;
  }

  .borrar-btn:hover {
    transform: scale(1.2);
  }

</style>

</head>
<body>

<h1>ğŸ“… Eventos del Servidor</h1>

<div class="eventos-box">
  <ul id="eventos-lista">
    <li>ğŸ“Œ No hay eventos. Â¡Crea uno!</li>
  </ul>
</div>

<button id="crearEventoBtn" class="btn">â• Crear evento</button>
<a href="index.html" class="btn">â¬… Volver al inicio</a>

<!-- FORMULARIO SIN CONTRASEÃ‘A VISIBLE -->
<div id="eventForm" style="display:none;" class="eventos-box">
  <h3>Crear nuevo evento</h3>

  <input type="text" id="nombreEvento" placeholder="Nombre del evento">
  <input type="date" id="diaEvento">
  <input type="time" id="horaEvento">
  <input type="text" id="lugarEvento" placeholder="Lugar / Juego / Canal Discord">
  <textarea id="descEvento" placeholder="DescripciÃ³n"></textarea>
  <input type="text" id="imgEvento" placeholder="URL de imagen/logo (opcional)">
  
  <button id="guardarEvento" class="btn">ğŸ’¾ Guardar evento</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.0.0/firebase-app.js";
import { getDatabase, ref, onValue, set, get }
from "https://www.gstatic.com/firebasejs/12.0.0/firebase-database.js";

/* CONFIG FIREBASE */
const firebaseConfig = {
  apiKey: "AIzaSyAVK1jVFsEvjzjQYLPp4nkGdRdMNJ9psPc",
  authDomain: "sepmc-2ab3d.firebaseapp.com",
  databaseURL: "https://sepmc-2ab3d-default-rtdb.firebaseio.com",
  projectId: "sepmc-2ab3d",
  storageBucket: "sepmc-2ab3d.appspot.com",
  messagingSenderId: "1015746236260",
  appId: "1:1015746236260:web:baf7779cc6fcbb5757b471"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);
const eventosRef = ref(db, "eventos/lista");

const lista = document.getElementById("eventos-lista");

/* CREAR EVENTO: PIDE CONTRASEÃ‘A */
document.getElementById("crearEventoBtn").addEventListener("click", () => {
  const pass = prompt("ğŸ”’ Ingresa la contraseÃ±a para crear eventos:");

  if (pass !== "1771") {
    alert("âŒ ContraseÃ±a incorrecta.");
    return;
  }

  document.getElementById("eventForm").style.display = "block";
});

/* GUARDAR EVENTO */
document.getElementById("guardarEvento").addEventListener("click", async () => {
  const nuevoEvento = {
    nombre: document.getElementById("nombreEvento").value,
    dia: document.getElementById("diaEvento").value,
    hora: document.getElementById("horaEvento").value,
    lugar: document.getElementById("lugarEvento").value,
    descripcion: document.getElementById("descEvento").value,
    imagen: document.getElementById("imgEvento").value
  };

  if (!nuevoEvento.nombre || !nuevoEvento.dia || !nuevoEvento.hora || !nuevoEvento.lugar) {
    alert("âŒ Completa todos los campos obligatorios.");
    return;
  }

  const snap = await get(eventosRef);
  let data = snap.val() || [];
  data.push(nuevoEvento);

  await set(eventosRef, data);

  alert("âœ… Evento creado!");
  document.getElementById("eventForm").style.display = "none";
});

/* MOSTRAR EVENTOS */
onValue(eventosRef, snapshot => {
  const data = snapshot.val() || [];
  lista.innerHTML = "";

  if (data.length === 0) {
    lista.innerHTML = '<li>ğŸ“Œ No hay eventos. Â¡Crea uno!</li>';
    return;
  }

  data.forEach((evento, index) => {
    const li = document.createElement("li");

    li.innerHTML = `
      <button class="borrar-btn" data-index="${index}">ğŸ—‘ï¸</button>
      <strong>${evento.nombre}</strong><br>
      ğŸ“… ${evento.dia} â° ${evento.hora}<br>
      ğŸ“ ${evento.lugar}<br>
      ${evento.imagen ? `<img src="${evento.imagen}" alt="imagen" style="max-width:120px;border-radius:10px;margin-top:8px;"><br>` : ""}
      ${evento.descripcion ? `<em>${evento.descripcion}</em>` : ""}
    `;

    lista.appendChild(li);
  });
});

/* BORRAR EVENTO (CON CONTRASEÃ‘A) */
document.addEventListener("click", async (e) => {
  if (e.target.classList.contains("borrar-btn")) {
    const index = e.target.getAttribute("data-index");

    const pass = prompt("ğŸ”’ Ingresa la contraseÃ±a para borrar este evento:");

    if (pass !== "1771") {
      alert("âŒ ContraseÃ±a incorrecta.");
      return;
    }

    const snap = await get(eventosRef);
    let data = snap.val() || [];

    data.splice(index, 1);

    await set(eventosRef, data);

    alert("ğŸ—‘ï¸ Evento eliminado");
  }
});

</script>

</body>
</html>
